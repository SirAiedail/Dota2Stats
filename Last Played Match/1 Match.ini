[Rainmeter]
Author=SirAiedail
Update=1000

[Metadata]
Name=Dota2Stats
Information=Display Dota 2 stats from dotabuff.com. Shows results of last played match
License=MIT
Version=1.0

; This skin uses data obtained at http://dotabuff.com/.

; --------------------------------
; Setup
; --------------------------------

; Open Variables.ini in the @Resources folder and follow instructions there

; --------------------------------
; Do not edit beyond this point!
; Unless you know what you're doing.
; --------------------------------

[Variables]
@include=#@#\Variables.ini

; ---------------------------------------------------------------------------------------------------
; Background
; ---------------------------------------------------------------------------------------------------

[MeterBackground]
Meter=Image
X=0
Y=0
H=105
W=195
SolidColor=#ColorBg#
LeftMouseUpAction=[!Refresh]

; --------------------------------
; Measures
; --------------------------------

[MeasureLastGame]
Measure=Plugin
Plugin=WebParser
Url=https://dotabuff.com/players/107014304/matches
RegExp='(?siU)<td class="cell-icon">.*src="(.*)".*<\/td>.*<td class="cell-large">(.*a>).*<td><a class="(.*)".*<\/td>.*<td class=".*">(.*div>).*<\/td>.*kda-record">(.*)<\/span>\W*<div'
; Index 1: Url to hero icon
; Index 2: Container holding game ID
; Index 3: Result
; Index 4: Game type
; Index 5: KDA

[MeasureLastGamesHeroIcon]
Measure=Plugin
Plugin=WebParser
Url="https://www.dotabuff.com[MeasureLastGame]"
Download=1
StringIndex=1

[MeasureLastGamesID]
Measure=Plugin
Plugin=WebParser
Url=[MeasureLastGame]
RegExp='(?siU)<a href="/matches/(.*)">'
; Index 1: ID of the last match, used to link there
StringIndex=2
StringIndex2=1

[MeasureLastGamesResult]
Measure=Plugin
Plugin=WebParser
Url=[MeasureLastGame]
StringIndex=3
Substitute="abandoned":"aband."
IfMatch=.*won.*
IfMatchAction= !SetOption MeterLastGamesResult FontColor #ColorGreen#
IfNotMatchAction= !SetOption MeterLastGamesResult FontColor #ColorRed#
IfMatchMode=1

[MeasureLastGamesType]
Measure=Plugin
Plugin=WebParser
Url=[MeasureLastGame]
RegExp='(?siU)^(.*)<div.*(><span.*)??>(.*)($|<\/.*>)'
StringIndex=4
StringIndex2=3
Substitute="All Random Deathmatch":"Deathmatch"

[MeasureLastGamesTypeRank]
Measure=Plugin
Plugin=WebParser
Url=[MeasureLastGamesType]
StringIndex=1

[MeasureLastGamesKDA]
Measure=Plugin
Plugin=WebParser
Url=[MeasureLastGame]
RegExp='(?siU)>(.*)<.*">(.*)<.*">(.*)<'
; Index 1: Kills
; Index 2: Deaths
; Index 3: Assists
StringIndex=5
StringIndex2=1

[MeasureLastGamesDeaths]
Measure=Plugin
Plugin=WebParser
Url=[MeasureLastGamesKDA]
StringIndex=2

[MeasureLastGamesAssists]
Measure=Plugin
Plugin=WebParser
Url=[MeasureLastGamesKDA]
StringIndex=3

; --------------------------------
; Meters
; --------------------------------

[MeterLastGame]
Meter=String
X=3
Y=3
FontColor=#Color#
FontFace=#Font#
FontSize=14
Text="Last Played Match"
AntiAlias=1
StringCase=UPPER
LeftMouseUpAction=!Execute ["http://www.dotabuff.com/matches/[MeasureLastGamesID]"]

[MeterLastGamesHeroIcon]
Meter=Image
X=118
Y=30
H=28
W=50
MeasureName=MeasureLastGamesHeroIcon
LeftMouseUpAction=!Execute ["http://www.dotabuff.com/matches/[MeasureLastGamesID]"]

[MeterLastGamesResult]
Meter=String
MeasureName=MeasureLastGamesResult
X=28
Y=32
FontColor=#Color#
FontFace=#Font#
FontSize=12
Text="%1"
AntiAlias=1
StringCase=UPPER
LeftMouseUpAction=!Execute ["http://www.dotabuff.com/matches/[MeasureLastGamesID]"]

[MeterLastGamesTypeRank]
Meter=String
MeasureName=MeasureLastGamesTypeRank
X=114
Y=61
FontColor=#Color#
FontFace=#Font#
FontSize=12
Text="%1"
AntiAlias=1
LeftMouseUpAction=!Execute ["http://www.dotabuff.com/matches/[MeasureLastGamesID]"]

[MeterLastGamesTypeMode]
Meter=String
MeasureName=MeasureLastGamesType
X=0r
Y=16r
FontColor=#Color#
FontFace=#Font#
FontSize=11
Text="%1"
AntiAlias=1
LeftMouseUpAction=!Execute ["http://www.dotabuff.com/matches/[MeasureLastGamesID]"]

[MeterLastGamesKDAName]
Meter=String
X=4
Y=57
FontColor=#Color#
FontFace=#Font#
FontSize=12
Text="KDA"
AntiAlias=1
LeftMouseUpAction=!Execute ["http://www.dotabuff.com/matches/[MeasureLastGamesID]"]

[MeterLastGamesKDA]
Meter=String
MeasureName=MeasureLastGamesKDA
MeasureName2=MeasureLastGamesDeaths
MeasureName3=MeasureLastGamesAssists
X=2r
Y=18r
FontColor=#Color#
FontFace=#Font#
FontSize=12
Text="%1 | %2 | %3"
AntiAlias=1
LeftMouseUpAction=!Execute ["http://www.dotabuff.com/matches/[MeasureLastGamesID]"]
